"use strict";function App(){if(!window||!document||!fetch)return alert("不支持當前瀏覽器");this.loginbtnE=document.getElementById("loginbtn"),this.userE=document.getElementById("user"),this.passE=document.getElementById("pass"),this.autoE=document.getElementById("check"),this.alertE=document.getElementById("alert"),this.verify=function(){if(0===this.value.trim().length)return this.value="",void this.classList.add("error");this.classList.remove("error")},this.Login=()=>{if(0!==this.userE.value.trim().length)if(0!==this.passE.value.trim().length){if("true"!==this.loginbtnE.dataset.state){this.loginbtnE.dataset.state=!0;var myHeaders=new Headers;myHeaders.append("Content-Type","application/json");var raw,requestOptions={method:"POST",headers:myHeaders,body:JSON.stringify({Username:this.userE.value,Password:this.passE.value,AutoLogin:this.autoE.checked}),redirect:"follow"};window.fetch("/luck/login/verify",requestOptions).then(response=>response.json()).then(result=>{try{if(this.alertE.innerText=result.message,200!==result.code)return this.loginbtnE.dataset.state=!1,void this.alertE.classList.add("errortxt");this.alertE.classList.remove("errortxt");var tokenData=JSON.stringify(result.data);localStorage.setItem("luckToken",tokenData),location.href="/luck/admin"}catch(error){this.loginbtnE.dataset.state=!1,this.alertE.innerText=error,this.alertE.classList.add("errortxt"),console.log(error)}}).catch(error=>{console.log("error",error),loginbtnE.dataset.loginState=0})}}else this.passE.classList.add("error");else this.userE.classList.add("error")},this.Run=()=>{this.userE.onchange=this.verify,this.passE.onchange=this.verify,this.loginbtnE.onclick=()=>!1,this.loginbtnE.addEventListener("click",this.Login);var _this=this;window.document.onkeydown=function(ev){var event=ev||event;13==event.keyCode&&_this.Login()}}}(new App).Run();